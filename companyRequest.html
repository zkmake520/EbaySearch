<html>
    <head>
        <title>
        
        </title>
        <script  type="text/javascript">
            var errorType = 0;
            function generateHTML(xmlDoc){
                htmlText ="<table border='2'>"
                htmlText+="<tbody>";
                htmlText+="<tr>";
                    companyList = xmlDoc.getElementsByTagName("Row");
                    nodeList = companyList.item(0).childNodes;
                    //test = companyList.getElementsByName("Data");
                   // document.getElementById('te').innerHTML = nodeList.length;
                if (companyList.length ==1){
                    alert("Error: NO Companies");
                    return;
                }
               // document.getElementById("output").innerHTML=nodeList.length;
                for(i =0; i < nodeList.length;i++){
                    if(nodeList.item(i).nodeType==1)
                    {  
                        node = nodeList.item(i).textContent;
        
                        htmlText +="<th>" +node+"</th>";
                    }
                }
                htmlText +="</tr>"
                for(i = 1; i < companyList.length;i++){
                    if(companyList.item(i).nodeType==1){
                        nodeList =companyList.item(i).childNodes;
                        htmlText +="<tr>";
                        for( j = 0; j < nodeList.length; j++){
                            if(nodeList[j].nodeType==1){
                                if(nodeList[j].nodeName == "HomePage"){
                                    if(nodeList[j].firstChild == null)
                                        htmlText +="<td>N.A.</td>";
                                    else htmlText += "<td style='font-size:13px;'><a href='"+nodeList[j].textContent+"'>"+nodeList[j].textContent+"</a></td>";
                                }
                                else if(nodeList[j].nodeName == "Logo"){
                                    if(nodeList[j].firstChild == null)
                                        htmlText +="<td>N.A.</td>";
                                    else htmlText +="<td><img src ='"+nodeList[j].textContent+"' width = '100px' height = '100px'></td>" ;
                                }
                                else{
                                    if(nodeList[j].firstChild == null)
                                        htmlText +="<td>N.A.</td>";
                                    else
                                        htmlText += "<td style='font-size:13px;'>"+nodeList[j].textContent+"</td>";
                                }
                                
                            }
                        }
                        htmlText +="</tr>";
                    }
                    
                }
                
               // htmlText +="</tr>";
                htmlText+="</tbody></table>";  
                
                hWin = window.open("", "companyForm", "status=yes,width=600,outHeight=600,innerWidth=600,height=600,scrollbars=1,resizable=1");            hWin.document.write(htmlText);
                hWin.document.close();
    
            }
            function xmlParse(url){
                function loadXML(url){
                    if (window.XMLHttpRequest)
                    {// code for IE7+, Firefox, Chrome, Opera, Safari
                        xmlhttp=new XMLHttpRequest();  
                    }
                    else {// code for IE6, IE5
                        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");  
                    }
                    xmlhttp.open("GET",url,false);
                    xmlhttp.onreadystatechange = function() {
                        if(xmlhttp.readyState == 4){
                            if(xmlhttp.status == 200) {
                                
                             } 
                             else if (xmlhttp.status == 404) {
                                 alert('File does not exist');
                                 return;
                             }
                        }
                    }
                    xmlhttp.send();
                    return xmlhttp.responseXML;    
                }
                var xmlDoc = loadXML(url); 
                if(xmlDoc.documentElement.nodeName=="parsererror"){
                    alert("Error in XML");
                    return;
                }
                xmlDoc =generateHTML(xmlDoc);
            }
            function query(name){
                if(!name){
                    alert("Error: Empty Input"); 
                }
                else{
                    xmlParse(name);       
                }
            } 
        </script>
    
    </head>
    <body>
        <H3 style="font-size:16px;text-align:center">
            Enter URL for Company List XML File
        </H3>
        <center>
            <form name ="result">
                <input type="text" name="company"><br><br>
                <input type="button" value="Submit Query"
                    onClick="query(result.company.value)" > 
            </form>
        </center>
    <noscript>
    </body>
</html>